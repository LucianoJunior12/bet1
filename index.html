<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Interagir com a Carteira</title>
</head>
<body>
    <h1>Carteira Digital</h1>
    <label for="senha">Senha:</label>
    <input type="password" id="senha"><br><br>
    <label for="valor">Valor:</label>
    <input type="number" id="valor" min="0" step="0.01"><br><br>
    <button onclick="depositar()">Depositar</button>
    <button onclick="sacar()">Sacar</button><br><br>
    <button onclick="pagarTaxas()">Pagar Taxas</button>

    <script>
        const contratoEndereco = '0xaEb1f6c21fa760f581877A819a7e76E72796fdc5';
        const contratoABI = [
	{
		"inputs": [
			{
				"internalType": "string",
				"name": "_novaSenha",
				"type": "string"
			}
		],
		"name": "definirSenha",
		"outputs": [],
		"stateMutability": "nonpayable",
		"type": "function"
	},
	{
		"inputs": [],
		"name": "depositar",
		"outputs": [],
		"stateMutability": "payable",
		"type": "function"
	},
	{
		"inputs": [
			{
				"internalType": "string",
				"name": "_senha",
				"type": "string"
			}
		],
		"stateMutability": "nonpayable",
		"type": "constructor"
	},
	{
		"anonymous": false,
		"inputs": [
			{
				"indexed": true,
				"internalType": "address",
				"name": "remetente",
				"type": "address"
			},
			{
				"indexed": false,
				"internalType": "uint256",
				"name": "valor",
				"type": "uint256"
			}
		],
		"name": "FundosDepositados",
		"type": "event"
	},
	{
		"anonymous": false,
		"inputs": [
			{
				"indexed": true,
				"internalType": "address",
				"name": "destinatario",
				"type": "address"
			},
			{
				"indexed": false,
				"internalType": "uint256",
				"name": "valor",
				"type": "uint256"
			}
		],
		"name": "FundosRetirados",
		"type": "event"
	},
	{
		"inputs": [
			{
				"internalType": "uint256",
				"name": "_valor",
				"type": "uint256"
			}
		],
		"name": "pagarTaxas",
		"outputs": [],
		"stateMutability": "nonpayable",
		"type": "function"
	},
	{
		"inputs": [
			{
				"internalType": "uint256",
				"name": "_valor",
				"type": "uint256"
			},
			{
				"internalType": "string",
				"name": "_senha",
				"type": "string"
			}
		],
		"name": "retirar",
		"outputs": [],
		"stateMutability": "nonpayable",
		"type": "function"
	},
	{
		"anonymous": false,
		"inputs": [
			{
				"indexed": true,
				"internalType": "address",
				"name": "destinatario",
				"type": "address"
			},
			{
				"indexed": false,
				"internalType": "uint256",
				"name": "valor",
				"type": "uint256"
			}
		],
		"name": "TaxasPagas",
		"type": "event"
	},
	{
		"inputs": [],
		"name": "owner",
		"outputs": [
			{
				"internalType": "address",
				"name": "",
				"type": "address"
			}
		],
		"stateMutability": "view",
		"type": "function"
	},
	{
		"inputs": [],
		"name": "saldo",
		"outputs": [
			{
				"internalType": "uint256",
				"name": "",
				"type": "uint256"
			}
		],
		"stateMutability": "view",
		"type": "function"
	},
	{
		"inputs": [],
		"name": "senha",
		"outputs": [
			{
				"internalType": "string",
				"name": "",
				"type": "string"
			}
		],
		"stateMutability": "view",
		"type": "function"
	}
];

        const web3 = new Web3(Web3.givenProvider);

        const contrato = new web3.eth.Contract(contratoABI, contratoEndereco);

        async function depositar() {
            const senha = document.getElementById('senha').value;
            const valor = document.getElementById('valor').value;

            // Verifica se a senha está correta
            // Substitua 'senhaCorreta' pela senha definida na carteira
            if (senha !== '130908') {
                alert('Senha incorreta!');
                return;
            }

            // Realiza o depósito no contrato
            await contrato.methods.depositar().send({ from: web3.eth.defaultAccount, value: web3.utils.toWei(valor, 'ether') });
            alert('Depósito realizado com sucesso!');
        }

        async function sacar() {
            const senha = document.getElementById('senha').value;
            const valor = document.getElementById('valor').value;

            // Verifica se a senha está correta
            // Substitua 'senhaCorreta' pela senha definida na carteira
            if (senha !== '130908') {
                alert('Senha incorreta!');
                return;
            }

            // Realiza o saque do contrato
            await contrato.methods.sacar(web3.utils.toWei(valor, 'ether'), senha).send({ from: web3.eth.defaultAccount });
            alert('Saque realizado com sucesso!');
        }

        async function pagarTaxas() {
            const senha = document.getElementById('senha').value;
            const valor = document.getElementById('valor').value;

            // Verifica se a senha está correta
            // Substitua 'senhaCorreta' pela senha definida na carteira
            if (senha !== 'senhaCorreta') {
                alert('Senha incorreta!');
                return;
            }

            // Realiza o pagamento de taxas do contrato
            await contrato.methods.pagarTaxas(web3.utils.toWei(valor, 'ether')).send({ from: web3.eth.defaultAccount });
            alert('Taxas pagas com sucesso!');
        }
    </script>
</body>
</html>
